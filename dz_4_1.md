Домашнее задание к занятию "4.1. Командная оболочка Bash: Практические навыки"
Обязательные задания

1. Есть скрипт:

a=1
b=2
c=a+b
d=$a+$b
e=$(($a+$b))
Какие значения переменным c,d,e будут присвоены?
Почему?

a=1
b=2
c=a+b 

echo $c выведет строку "a+b" т.к. изначально переменные не объявлены как целочисленные.

d=$a+$b && echo $d выведет строку "a+b" т.к. изначально переменные не объявлены как целочисленные 

и попрежнему являются строками


e=$(($a+$b)) && echo $e выведет "3" т.к. в такой записи переменные a и b считаются числами.




2. На нашем локальном сервере упал сервис и мы написали скрипт, который постоянно проверяет его 

доступность, записывая дату проверок до тех пор, пока сервис не станет доступным. В скрипте 

допущена ошибка, из-за которой выполнение не может завершиться, при этом место на Жёстком Диске 

постоянно уменьшается. Что необходимо сделать, чтобы его исправить:

while ((1==1)
do
curl https://localhost:4757
if (($? != 0))
then
date >> curl.log
fi
done


#!/usr/bin/env bash
# нет закрывающей скобки
while ((1==1)) 
do
curl https://localhost:4757
if (($?!=0))
then
date >> curl.log
# уменьшить частоту проверок
sleep 2
#выйти из цикла если сервис стал доступен
else break 
fi
done
# сообщить о доступности сервиса
echo service UP



3. Необходимо написать скрипт, который проверяет доступность трёх IP: 192.168.0.1, 

173.194.222.113, 87.250.250.242 по 80 порту и записывает результат в файл log. Проверять 

доступность необходимо пять раз для каждого узла.


#!/usr/bin/env bash
d1=`date`
ip1="http://192.168.1.1:80"
ip2="http://192.168.1.2:80"
ip3="http://192.168.1.3:80"
# echo $ip1
array_ip=($ip1 $ip2 $ip3)
echo ${array_ip[@]}
for ip in ${array_ip[@]}
do
    for ((i=1;i<=5;i++))
<------>do
<------>echo $i
<------>echo $ip
<------>curl $ip
<------>if (($?==0))
<------>then
<------>echo $d1 $ip UP $i >> curl1.log
<------>else
<------>echo $d1 $ip DOWN $i >> curl1.log
<------>fi
<------>done
done

вывод curl1.log

Вс дек 12 15:41:09 +05 2021 http://192.168.1.1:80 UP 1
Вс дек 12 15:41:09 +05 2021 http://192.168.1.1:80 UP 2
Вс дек 12 15:41:09 +05 2021 http://192.168.1.1:80 UP 3
Вс дек 12 15:41:09 +05 2021 http://192.168.1.1:80 UP 4
Вс дек 12 15:41:09 +05 2021 http://192.168.1.1:80 UP 5
Вс дек 12 15:41:09 +05 2021 http://192.168.1.2:80 UP 1
Вс дек 12 15:41:09 +05 2021 http://192.168.1.2:80 UP 2
Вс дек 12 15:41:09 +05 2021 http://192.168.1.2:80 UP 3
Вс дек 12 15:41:09 +05 2021 http://192.168.1.2:80 UP 4
Вс дек 12 15:41:09 +05 2021 http://192.168.1.2:80 UP 5
Вс дек 12 15:41:09 +05 2021 http://192.168.1.3:80 DOWN 1
Вс дек 12 15:41:09 +05 2021 http://192.168.1.3:80 DOWN 2
Вс дек 12 15:41:09 +05 2021 http://192.168.1.3:80 DOWN 3
Вс дек 12 15:41:09 +05 2021 http://192.168.1.3:80 DOWN 4
Вс дек 12 15:41:09 +05 2021 http://192.168.1.3:80 DOWN 5





4. Необходимо дописать скрипт из предыдущего задания так, чтобы он выполнялся до тех пор, пока 

один из узлов не окажется недоступным. Если любой из узлов недоступен - IP этого узла пишется в 

файл error, скрипт прерывается


#!/usr/bin/env bash
d1=`date`
ip1="http://192.168.1.1:80"
ip2="http://192.168.1.2:80"
ip3="http://192.168.1.3:80"
# echo $ip1
array_ip=($ip1 $ip2 $ip3)
echo ${array_ip[@]}

while ((1==1))
do
    for ip in ${array_ip[@]}
    do
<------>curl $ip
<------>if (($?==0))
<------>then
<------>echo $d1 $ip UP >> curl2.log
<------>else
<------>echo $ip >> error.log
<------>exit
<------>fi
    done
done






